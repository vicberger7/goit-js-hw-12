{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nconst domElements = {\n  formEl: document.querySelector('.js-search-form[data-id=\"1\"]'),\n  imageEl: document.querySelector('.js-image-container'),\n  loadMoreBtn: document.querySelector('.load-more-btn'),\n};\n\nconst loader = document.querySelector('.loader');\nloader.style.display = 'none';\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nasync function searchImage(imageName, page = 1, perPage = 15) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const searchParams = new URLSearchParams({\n    key: '42138103-4c7bc70fd41b029843ebe333e',\n    q: imageName,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: perPage,\n  });\n  const PARAMS = `?${searchParams}`;\n  const url = BASE_URL + PARAMS;\n\n  try {\n    const response = await axios.get(url);\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n  }\n}\n\nfunction displayImages(images, clearPrevious = true) {\n  const imageContainer = document.querySelector('.js-image-container');\n\n  if (clearPrevious) {\n    imageContainer.innerHTML = '';\n  }\n\n  const galleryHTML = images\n    .map(image => {\n      return `\n      <a href=\"${image.largeImageURL}\" class=\"lightbox\">\n        <div class=\"image-card\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n          <span>Likes: ${image.likes}</span>\n          <span>Views: ${image.views}</span>\n          <span>Comments: ${image.comments}</span>\n          <span>Downloads: ${image.downloads}</span>\n        </div>\n      </a>\n    `;\n    })\n    .join('');\n\n  if (!clearPrevious) {\n    imageContainer.insertAdjacentHTML('beforeend', galleryHTML);\n  } else {\n    imageContainer.innerHTML = galleryHTML;\n  }\n  lightbox.refresh();\n\n  const cardHeight = document\n    .querySelector('.image-card')\n    .getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nconst lightbox = new SimpleLightbox('.js-image-container  a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet searchQuery = '';\nlet currentPage = 1;\n\ndomElements.formEl.addEventListener('submit', async e => {\n  e.preventDefault();\n  showLoader();\n  const name = e.target.elements.query.value.trim();\n\n  if (!name) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query!',\n    });\n    searchQuery = '';\n    currentPage = 1;\n    domElements.loadMoreBtn.style.display = 'none';\n    return hideLoader();\n  }\n\n  searchQuery = name;\n  currentPage = 1;\n\n  try {\n    const data = await searchImage(name);\n    if (data.hits.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    } else {\n      displayImages(data.hits);\n      if (data.hits.length >= 15) {\n        domElements.loadMoreBtn.style.display = 'block';\n      }\n    }\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n\nlet loadMoreEnabled = true;\n\nasync function loadMoreImages() {\n  try {\n    if (!loadMoreEnabled) return;\n    showLoader();\n    currentPage++;\n    const data = await searchImage(searchQuery, currentPage);\n    if (data.hits.length === 0) {\n      loadMoreEnabled = false;\n      domElements.loadMoreBtn.classList.add('disabled');\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      displayImages(data.hits, false);\n    }\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to load more images!',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\ndomElements.loadMoreBtn.addEventListener('click', () => {\n  if (loadMoreEnabled) {\n    loadMoreImages();\n  }\n});\n"],"names":["domElements","loader","showLoader","hideLoader","searchImage","imageName","page","perPage","BASE_URL","PARAMS","url","axios","error","displayImages","images","clearPrevious","imageContainer","galleryHTML","image","lightbox","cardHeight","SimpleLightbox","searchQuery","currentPage","e","name","iziToast","data","loadMoreEnabled","loadMoreImages"],"mappings":"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"}